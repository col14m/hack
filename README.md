This solution took 2nd place on the hackathon for data analysis.
https://vk.com/start.mipt?w=wall-161664433_686
